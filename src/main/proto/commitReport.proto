syntax = "proto3";

option java_multiple_files = true;
option java_package = "net.explorviz.code.proto";
option java_outer_classname = "CommitReport";

import "google/protobuf/empty.proto";

service CommitReportService {
  rpc sendCommitReport (CommitReportData) returns (google.protobuf.Empty) {}
}

message CommitReportData {
  string landscape_token = 1;
  string commit_id = 2;
  string parent_commit_id = 3;
  string branch_name = 4;

  // Git file metrics
  repeated FileInfo unchanged_files = 5;
  repeated FileInfo added_files = 6;
  repeated FileInfo modified_files = 7;
  repeated FileInfo deleted_files = 8;

  repeated string tags = 9;
  string application_name = 10;
  string repository_name = 11;
}

message FileInfo {
  string file_hash = 1;
  
  // Path relative to repo root
  string file_path = 2;
}
